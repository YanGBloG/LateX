\immediate\write18{makeindex C-1.nlo -s nomencl.ist -o C-1.nls}
\documentclass[12pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage{vietnam}
\usepackage[left=3cm, right=2.2cm, top=2.5cm, bottom=2.5cm]{geometry}
\usepackage{amsmath}
\usepackage{float}
\usepackage{amssymb} 
\usepackage{graphicx} 
\usepackage[hidelinks, unicode]{hyperref}
\usepackage[labelsep=period]{caption}
\usepackage[table]{xcolor}
\usepackage{titletoc}
\usepackage{etoc}
\usepackage{mathptmx}
\usepackage{sectsty}
\usepackage{multirow}
\usepackage{booktabs, tabularx}
\usepackage{courier}
\usepackage{subfig}
\usepackage{nomencl}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{anyfontsize}
\usepackage{tikz}
\usepackage[fontsize=13pt]{scrextend}
\newcommand{\code}[1]{\texttt{#1}}
\renewcommand{\baselinestretch}{1.5}
\renewcommand{\nomname}{Danh mục ký hiệu và viết tắt}

\usetikzlibrary{shapes.geometric, arrows}

\tikzstyle{startstop} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=red!30]
\tikzstyle{io} = [trapezium, trapezium left angle=70, trapezium right angle=110, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=blue!30]
\tikzstyle{process} = [rectangle, minimum width=3cm, minimum height=1cm, text centered, text width=3cm, draw=black, fill=orange!30]
\tikzstyle{decision} = [diamond, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=green!30]
\tikzstyle{arrow} = [thick,->,>=stealth]

\makenomenclature
\makeatletter
\titlecontents{chapter}[3cm] % <-- seems to set some specific left margin
{\color{black}\bfseries\addvspace{3mm}}
{\makebox[0cm][r]{\MakeUppercase\@chapapp\hspace{.5em}\thecontentslabel\hspace{0.75cm}}}
{} %     ^^^ pretendously zero width box puts its contents in the left margin
{\hfill\makebox[-2cm]{\thecontentspage}}  % 3cm = twice 1.5cm
\chapternumberfont{\Large}
\chaptertitlefont{\Large}

\titleformat{\chapter}[hang] 
{\normalfont\fontsize{14}{15}\bfseries}{CHƯƠNG \thechapter.}{1em}{} 
\titlespacing*{\chapter}{0pt}{-7pt}{7pt}

\titleformat{\section}
{\normalfont\fontsize{13}{15}\bfseries}{\thesection.}{1em}{}
\titlespacing*{\section}{0pt}{-5pt}{-6pt}  

\titleformat{\subsection}
{\normalfont\fontsize{13}{15}\bfseries\itshape}{\thesubsection.}{1em}{}
\titlespacing*{\subsection}{0pt}{-20pt}{-6pt}

\titleformat{\subsubsection}
{\normalfont\fontsize{13}{15}\itshape}{\thesubsubsection.}{1em}{}
\titlespacing*{\subsubsection}{0pt}{-20pt}{-6pt}


\newcommand{\subsubsubsection}[1]{\paragraph{#1}\mbox{}\\}


\setlist[itemize]{itemsep=-0.3em, topsep=0pt}
\setlength\parindent{0pt}
\setlength{\parskip}{10pt}
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}
\geometry{letterpaper}

% \title{\textbf{LUẬN VĂN TỐT NGHIỆP}}
% \author{Bùi Trọng Nghĩa}

\begin{document}
\pagenumbering{gobble}
% \thispagestyle{empty}
\clearpage

\pdfbookmark{\contentsname}{content}
% \maketitle

\tableofcontents
\addcontentsline{toc}{section}{MỤC LỤC}

\listoffigures
\addcontentsline{toc}{section}{DANH SÁCH HÌNH VẼ}

\listoftables
\addcontentsline{toc}{section}{DANH SÁCH BẢNG BIỂU}

\printnomenclature
\addcontentsline{toc}{section}{DANH MỤC KÝ HIỆU VÀ VIẾT TẮT}

\clearpage
\pagenumbering{arabic}
\newpage

\chapter{CƠ SỞ LÝ THUYẾT}
\section{Các phương pháp khai thác nhân tạo}
Thông thường, trong giai đoạn đầu của một giếng khai thác dòng lưu chất từ vỉa sẽ khai thác nhờ áp suất vỉa (nếu áp suất vỉa lớn hơn tổng áp suất mất mát của hệ thống khai thác), giai đoạn này được gọi là khai thác tự phun. Nếu như áp suất vỉa không còn đủ lớn để có thể thắng được áp suất mất mát, dòng chảy trong giếng sẽ ``chết'' và giếng không thể tiếp tục khai thác tự phun được nữa. Hai nguyên nhân chính dẫn đến dòng trong giếng bắt đầu ``chết'' chính là:
	\begin{itemize}
		\item Áp suất dòng vào ở đáy giếng giảm xuống thấp hơn tổng áp suất mất mát của giếng,
		\item Tổng áp suất mất mát của giếng lớn hơn áp suất đáy giếng nhỏ nhất để có thể đưa được dòng lưu chất lên bề mặt.
	\end{itemize}
Trường hợp đầu tiên xảy ra khi lưu chất được khai thác khỏi vỉa sẽ dẫn tới áp suất của vỉa suy giảm theo thời gian cho tới khi không còn đủ lớn để thắng được áp suất mất mát của hệ thống khai thác. Đối với trường hợp thứ hai, thường do tăng mức độ cản trở dòng chảy trong hệ thống, có hai nguyên nhân dẫn đến điều này:
	\begin{itemize}
		\item Tỉ trọng của dòng lưu chất tăng do lượng khí đồng hành giảm,
		\item Các vấn đề cơ học như kích thước tubing nhỏ, lắng đọng cặn ...
	\end{itemize}
Khai thác nhân tạo được thực hiện khi dòng chảy trong giếng bắt đầu ``chết'' hoặc tăng lưu lượng khai thác của giếng. Hai phương pháp phổ biến nhất thường được lựa chọn để thực hiện khai thác nhân tạo là bơm điện li tâm chìm (ESP)\nomenclature{ESP}{Electrical Submersible Pump}; một máy bơm sẽ được đặt xuống lòng giếng dưới mực lưu chất trong giếng, bơm tăng áp suất để thắng được tổn thất áp suất trong hệ thống; và bơm ép khí từ bề mặt vào trong tubing khai thác để dòng lưu chất dễ dàng phun lên bề mặt hơn (gas lift). Ngoài ra vẫn còn một số phương pháp khai thác nhân tạo khác nhưng không được sử dụng phổ biến.\\

\subsection{Bơm điện li tâm chìm}
\subsubsection{Ứng dụng}
Được đưa vào ứng dụng trong thực tiễn từ năm 1920 tại mỏ Oklahoma, ESP có thể nâng lưu lượng khai thác thêm tới 1000 thùng trên ngày, gấp khoảng 2 đến 3 lần bơm cần (rod pump).

Ngày nay, bơm điện li tâm chìm thường được ứng dụng trong bơm ép nước (trên bờ), khai thác trên biển hoặc trong những trường hợp có sẵn nguồn điện và khai thác với lưu lượng lớn. ESP có thể được lắp đặt ở độ sâu 1,000 ft đến 10,000 ft đồng thời tăng lưu lượng khai thác thêm từ 200 bbl/d đến 20,000 bbl/d (Hình \ref{fig:rate-vs-depth}). Kỉ lục độ sâu và lưu lượng có thể sử dụng ESP là 15,000 ft và 30,000 bbl/d.\\

	\begin{figure}[h]
		\centering
		\includegraphics[scale=0.6]{fig/rate-vs-depth.png}
		\caption{Lưu lượng khai thác tối đa theo độ sâu}
		\label{fig:rate-vs-depth}
	\end{figure}

\subsubsection{Ưu điểm và hạn chế}

Một vài ưu điểm của bơm điện li tâm chìm có thể kể đến như sau:
	\begin{itemize}
		\item Thích hợp với khai thác lưu lượng lớn,
		\item Hiệu suất cao,
		\item Sử dụng tốt trong giếng khoan định hướng,
		\item Có thể sử dụng trong điều kiện khu dân cư,
		\item Thích hợp với hoạt động khai thác trên biển,
		\item Dễ dàng sử lý ăn mòn và lắng đọng.
	\end{itemize}
ESP cũng có một vài hạn chế:
	\begin{itemize}
		\item Phụ thuộc vào nguồn cung cấp năng lượng,
		\item Cần được vận hành trong điều kiện ổn định,
		\item Dễ bị ảnh hưởng bởi cát hay các vật chất gây ăn mòn,
		\item Quá trình sửa chửa khó khăn,
		\item Bị hạn chế trong vùng có nhiệt độ cao,
		\item Hiệu suất thấp đối với dầu có độ nhớt cao,
		\item Chi phí lắp đặt cao.\\
	\end{itemize}

\subsection{Gas lift}
Gas lift là phương pháp bơm ép khí vào cột lưu chất trong giếng để lưu chất có thể dễ dàng được khai thác hơn. Hệ thống bề mặt cơ bản cho phương pháp gas lift được thể hiện như trong Hình \ref{fig:gas-lift-system}. Hầu hết khí được sử dụng trong bơm ép là khí tự nhiên có đặc tính trơ, được bơm ép vào trong tubing tại những vị trí đã được thiết kế trước, dựa trên ba nguyên lý chủ yếu: giảm tỉ trọng hỗn hợp lưu chất, năng lượng giản nở của khí và thay thế vị trí. Từ đó dòng lưu chất tại đáy giếng có thể tiếp tục được đưa lên bề mặt và giếng bắt đầu được khai thác trở lại hoặc nâng cao năng suất khai thác. Có thể chia gas lift thành hai loại là gas lift định kì và gas lift liên tục.

	\begin{figure}[h]
		\centering
		\includegraphics[scale=.6]{fig/gas-lift-system.png}
		\caption{Hệ thống bơm ép gas lift (bề mặt)}
		\label{fig:gas-lift-system}
	\end{figure}

Đối với gas lift liên tục, dòng khí được bơm liên tục có kiểm soát vào trong tubing trong khi gas lift định kì sẽ thực hiện bơm khí theo chu kì nhất định khi lưu chất trong tubing có xu hướng tích tụ về đáy giếng. Sơ đồ lắp đặt một giếng khai thác sử dụng gas lift như Hình \ref{fig:continuous-gas-lift}.

Trong đó, đối với gas lift liên tục van thấp nhất sẽ được mở liên tục để thực hiện bơm ép khí, các van còn lại được vận hành tùy vào mục đích của người vận hành. Đối với gas lift định kì, các van sẽ được mở tùy theo thời gian bơm ép định kì đã lên theo kế hoạch và đóng trong những khoảng thời gian khác. Thông thường trong thời gian bơm ép van số 5 (theo sơ đồ Hình \ref{fig:continuous-gas-lift}) sẽ được mở trước tiên, các van khác được vận hành tùy theo mục đích.

Lưu lượng khí bơm ép cho mỗi giếng được phân chia tùy thuộc vào đặc tính của giếng đó. Trong phạm vi của luận án, tác giả sẽ đi vào xây dựng mô hình phân phối lưu lượng khí cho từng giếng theo cụm giếng chung hệ thống ống góp (manifold). Mô hình sẽ không phân biệt phương pháp gas lift liên tục hay định kì, chỉ đưa ra lưu lượng khí bơm ép cho mỗi giếng dưới điều kiện tổng lượng khí bơm ép xác định để đạt được lưu lượng dầu tối đa trong điều kiện bình tách có thể chịu được.

	\begin{figure}[h]
		\centering
		\includegraphics[scale=0.7]{fig/continuous-gas-lift.png}
		\caption{Sơ đồ giếng khai thác với gas lift}
		\label{fig:continuous-gas-lift}
	\end{figure}

\subsubsection{Ứng dụng}
Lần đầu tiên gas lift được đưa vào trong khai thác năm 1846 tại Mĩ, tuy nhiên để sử dụng khai thác nước là chủ yếu. Đến năm 1930 gas lift mới thực sự được đưa vào ứng dụng trong ngành công nghiệp dầu khí cùng với sự ra đời của các mẫu van gas lift khác nhau. Vào những năm này gas lift được sử dụng do hai nguyên chính:
	\begin{itemize}
		\item Tăng mạnh lưu lượng khai thác trong khi năng lượng vỉa bắt đầu suy kiệt,
		\item Đem lại nhiều lợi ích kinh tế khi lượng khí bơm ép sau sử dụng có thể được tách và sử dụng lại, ít bị thất thoát trong quá trình sử dụng.
	\end{itemize}
Trong ngành công nghiệp dầu khí hiện đại, gas lift có những ứng dụng chính như sau:
	\begin{itemize}
		\item Đưa giếng trở lại khai thác sau khi đã kết thúc giai đoạn khai thác tự nhiên,
		\item Tăng lưu lượng khai thác,
		\item Loại bỏ thành phần lỏng trong các giếng khai thác khí,
		\item Xử lý những giếng lắng đọng cát trong giai đoạn bắn mở vỉa,
		\item Khai thác nước cho quá trình bơm ép nước.\\
	\end{itemize}

\subsubsection{Ưu điểm và hạn chế}
Gas lift được xem là một trong những phương pháp phổ biến nhất trong các phương pháp khai thác nhân tạo, phù hợp cho những giếng có độ sâu lớn mà những phương pháp khác không thể thực hiện được. Một số ưu điểm chính có thể kể đến như sau:

Gas lift liên tục:
	\begin{itemize}
		\item Tận dụng tối đa lợi ích do nguồn khí đem lại,
		\item Khai thác lưu lượng lớn,
		\item Thiết bị phổ biến,
		\item Sử dụng được cho giếng có nhiều cát,
		\item Có thể thu hồi van bằng tubing hay dây cáp.
	\end{itemize}
Gas lift định kì:
	\begin{itemize}
		\item Sử dụng được ở điều kiện áp suất dòng vào thấp hơn so với gas lift liên tục,
		\item Thiết bị phổ biến,
		\item Có thể thu hồi van bằng tubing hay dây cáp.
	\end{itemize}

Đồng thời gas lift cũng mang một vài hạn chế như:

Gas lift liên tục:
	\begin{itemize}
		\item Cần nguồn cung cấp khí ổn định,
		\item Không thể triển khai đối với giếng có áp suất quá thấp hoặc có thể nhưng lưu lượng khai thác không khả quan.
	\end{itemize}
Gas lift định kì:
	\begin{itemize}
		\item Không thể cho dòng khai thác lưu lượng lớn,
		\item Có thể gây ra hiệu ứng vọt xung trên bề mặt (surge),
		\item Cần nguồn cung cấp khí ổn định.
	\end{itemize}
Ngoài ra, chi phí ban đầu để triển khai thực hiện gas lift khá cao, quá trình bảo trì và vận hành không dễ dàng.\\

\subsection{Một số phương pháp khác}
Một số phương pháp khai thác nhân tạo khác có thể kể đến như bơm cần, bơm thủy lực hay bơm trục vít. Tuy nhiên, hiện tại các phương pháp không còn được sử dụng phổ biến như hai phương pháp bơm điện li tâm chìm và gas lift. Ưu, nhược điểm của các phương pháp này có thể được kể đến như sau:

Bơm cần (sucker-rod pump)

\begin{table}[h]
\centering
\begin{tabularx}{\textwidth}{@{}XX@{}}
 \multicolumn{1}{c}{Ưu điểm} & \multicolumn{1}{c}{Hạn chế} \\
 \textbullet\ \hspace{0.5cm} Hiệu suất khá cao & \textbullet\ \hspace{0.5cm} Lưu lượng khai thác hạn chế \\
 \textbullet\ \hspace{0.5cm} Chi phí thấp &  \\
 \textbullet\ \hspace{0.5cm} Giảm thiểu ăn mòn &  \\
 \textbullet\ \hspace{0.5cm} Linh hoạt &  \\
 \textbullet\ \hspace{0.5cm} Dễ dàng triển khai cứu hộ và bảo trì & \\
\end{tabularx}
\end{table}

\newpage

Bơm trục vít (progressive cavity pump)

\begin{table}[h]
\centering
\begin{tabularx}{\textwidth}{@{}XX@{}}
 \multicolumn{1}{c}{Ưu điểm} & \multicolumn{1}{c}{Hạn chế} \\
 \textbullet\ \hspace{0.5cm} Hiệu suất khá cao & \textbullet\ \hspace{0.5cm} Bị giới hạn bởi độ sâu giếng \\
 \textbullet\ \hspace{0.5cm} Chi phí đầu tư và bảo trì thấp &  \\
 \textbullet\ \hspace{0.5cm} Ít tiêu tốn năng lượng &  \\
 \textbullet\ \hspace{0.5cm} Có khả năng bơm dầu nặng &  \\
 \textbullet\ \hspace{0.5cm} Dễ dàng triển khai lắp đặt & \\
\end{tabularx}
\end{table}

Bơm thủy lực (subsurface hydraulic pump)

\begin{table}[h]
\centering
\begin{tabularx}{\textwidth}{@{}XX@{}}
 \multicolumn{1}{c}{Ưu điểm} & \multicolumn{1}{c}{Hạn chế} \\
 \textbullet\ \hspace{0.5cm} Linh hoạt trong khai thác đa tầng & \textbullet\ \hspace{0.5cm} Chi phí đầu tư ban đầu cao \\
 \textbullet\ \hspace{0.5cm} Có thể cho lưu lượng khai thác lớn & \textbullet\ \hspace{0.5cm} Vận hành phức tạp \\
 \textbullet\ \hspace{0.5cm} Tần suất bảo trì thấp & \textbullet\ \hspace{0.5cm} Hiệu quả kinh tế cao chỉ khi khai thác đa tầng, đa giếng \\
 \textbullet\ \hspace{0.5cm} Độ sâu khai thác lớn (bơm piston) & \textbullet\ \hspace{0.5cm} Quá trình bảo trì khó khăn \\
\end{tabularx}
\end{table}

\section{Trí tuệ nhân tạo}
Trí tuệ nhân tạo hay Artificial Intelligence (AI)\nomenclature{AI}{Artificial Intelligence} là một phương pháp sử dụng sức mạnh của máy tính để giải những bài toán khó trong đó có bài toán tối ưu hóa. Để có thể giải được những bài toán tối ưu hóa hiện đại, những kĩ thuật cổ điển không còn thích hợp; tuy nhiên, khi không gian tối ưu lớn đi kèm các ràng buộc đặc biệt cần phải sử dụng những kĩ thuật thích hợp. \textit{Giải thuật di truyền} và \textit{mạng thần kinh nhân tạo} (hay mạng neural nhân tạo, ANN)\nomenclature{ANN}{mạng thần kinh nhân tạo} là hai trong những kĩ thuật đó.\\

\subsection{Giải thuật di truyền}
\subsubsection{Nguyên lý giải thuật}
Giải thuật di truyền (Genetic Algorithms, GA)\nomenclature{GA}{Giải thuật di truyền}; thuật ngữ ``giải thuật'' ở đây chính là các thuật toán để giải quyết một vấn đề; được mô phỏng dựa trên các hiện tượng sinh học tự nhiên: \textit{kế thừa} và \textit{đấu tranh sinh tồn} để thực hiện cải tiến, khảo sát không gian của lời giải. Khái niệm kế thừa và đấu tranh sinh tồn có thể được giải thích như sau:

Giả sử có một quần thể các cá thể loài chồn, bao gồm những cá thể vượt trội có sự linh hoạt, nhạy bén cao, khỏe mạnh và những cá thể yếu ớt không đủ linh hoạt nhạy bén. Những cá thể vượt trội có xác suất sinh tồn trong môi trường tự nhiên cao hơn các cá thể yếu ớt, dĩ nhiên một số cá thể yếu ớt cũng có thể sống được nhờ may mắn đó chính là đấu tranh sinh tồn. Đến một giai đoạn nào đó các cá thể chồn còn lại bắt đầu sinh sản, thế hệ các chú chồn tiếp theo sẽ được kế thừa các đặc tính di truyền của các con bố và mẹ, tất nhiên là có một số con mang đặc tính của những con yếu ớt còn sót lại; điều này chính là kế thừa. Đôi khi sẽ có thêm những cá thể đột biến do mang đặc tính di truyền từ một các thể khác lạc vào quần thể chồn này, cá thể đột biến này có thể tốt hoặc xấu. Do đó, thế hệ sau luôn mang một xác suất cao cho ra những cá thể tốt hơn thế hệ trước. Tất nhiên quần thể những loài thú săn chồn cũng mang đặc tính kế thừa và đấu tranh này.

Quá trình tìm kiếm ngiệm của bài toán tối ưu bằng giải thuật di truyên cũng thực hiện các bước tương tự với quá trình đấu tranh sinh tồn của quần thể chồn. 

Giải thuật di truyền sử dụng một số thuật ngữ được lấy từ di truyền học như: cá thể, quần thể, nhiễm sắc thể, kiểu gen. Một cá thể cũng là một nhiễm sắc thể đươc cấu tạo từ các gen, mỗi gen mang một đặc trưng khác nhau. Trong toán học một nghiệm của phương trình chính là nhiễm sắc thể, một thành phần trong nghiệm chính là một gen, tập hợp của một số các cặp số có thể trở thành nghiệm của phương trình chính là quần thể. Ví dụ tìm cực trị của hàm số hai biến $x$, $y$ sau:
	\begin{equation}\label{eqn:ex-genetic}
		f(x, y) = x^2y + y^2x
	\end{equation}
Giả sử $A = (x_1, y_1)$ chính là một nghiệm của \ref{eqn:ex-genetic}, như vậy $A$ sẽ là một nhiễm sắc thể; $x_1$, $y_1$ là các gen của nhiễm sắc thể $A$; tập hợp $A_1 \to A_N$ là một quần thể chứa các nhiễm sắc thể có thể là nghiệm của \ref{eqn:ex-genetic} với số lượng cá thể $N$ tùy thuộc vào sự lựa chọn của người giải.\\

\subsubsection{Thuật toán di truyền}
Một thuật toán di truyền để giải bất kì một bài toán cụ thể nào phải bao gồm năm điểm sau:
	\begin{itemize}
		\item Cách biểu diễn di truyền cho lời giải của bài toán,
		\item Các khởi tạo quần thể ban đầu,
		\item Một hàm lượng giá đóng vai trò là môi trường, đánh giá các lời giải theo mức độ ``thích nghi'' của chúng,
		\item Các phép toán di truyền,
		\item Các tham số khởi tạo (kích thước quần thể, xác suất áp dụng các phép toán di truyền, hoán đổi...).
	\end{itemize}
Cụ thể thuật toán di truyền được diễn giải thông qua các phép sau:

\textit{a. Phép chọn}

Phép chọn là quá trình loại bỏ các cá thể xấu trong quần thể chỉ giữ lại những các thể tốt dựa trên độ thích nghi của mỗi cá thể. Độ thích nghi là một hàm gán một giá trị thực cho các cá thể trong quần thể. Phép chọn có thể được mô phỏng như sau:
	\begin{itemize}
		\item Đánh giá độ thích nghi của từng cá thể trong quần thể hiện hành,
		\item Sắp xếp quần thể theo độ thích nghi giảm dần,
		\item Loại bỏ các cá thể cuối dãy, chỉ giữ lại $n$ cá thể tốt nhất.
	\end{itemize}

\textit{b. Phép lai}

Phép lai là quá trình hình thành nhiễm sắc thể mới trên cơ sở các nhiễm sắc thể bố-mẹ, bằng cách ghép một hay nhiều đoạn gen của hai (hay nhiều) nhiễm sắc thể bố-mẹ với nhau. Phép lai xảy ra với xác suất $p_c$, có thể mô phỏng như sau:
	\begin{itemize}
		\item Chọn ngẫu nhiên hai (hay nhiều) cá thể bất kỳ trong quần thể. Giả sử các nhiễm sắc thể bố-mẹ đều có $m$ gen,
		\item Tạo ngẫu nhiên một số tự nhiên trong đoạn $[1, m-1]$ (điểm lai). Điểm lai chia các chuỗi bố-mẹ dài $m$ thành hai nhóm chuỗi con dài $m_1$, $m_2$. Hai chuỗi nhiễm sắc thể con mới sẽ là $m_{11} + m_{22}$ và $m_{12} + m_{21}$.
	\end{itemize}

\textit{c. Phép đột biến}

Đột biến là hiện tượng cá thể con mang một số tính trạng không có trong mã gen di truyền của bố-mẹ. Phép đột biến xảy ra với xác suất $p_m$ nhỏ hơn rất nhiều so với xác suất lai $p_c$. Phép đột biến có thể mô phỏng như sau:
	\begin{itemize}
		\item Chọn ngẫu nhiên một cá thể bất kì bố-mẹ trong quần thể,
		\item Tạo ngẫu nhiên một số tự nhiên $k$ trong đoạn $[1, m]$,
		\item Thay đổi gen thứ $k$ và trả cá thể này về quần thể để tham gia quá trình tiến hóa tiếp theo.
	\end{itemize}

\textit{d. Phép tái sinh}

Phép tái sinh là quá trình trong đó các cá thể được sao chép trên cơ sở độ thích nghi của nó. Quá trình này có thể được mô tả như sau:
	\begin{itemize}
		\item Tính độ thích nghi của từng cá thể trong quần thể hiện hành, lập bảng cộng dồn các giá trị thích nghi (theo số thứ tự cho từng cá thể). Giả sử quần thể có $n$ cá thể. Gọi độ thích nghi của cá thể thứ $i$ là $F_i$, tổng cộng dồn thứ $i$ là $F_{ti}$, tổng độ thích nghi của toàn quần thể là $F_{m}$,
		\item Tạo một số ngẫu nhiên $F$ trong đoạn $[0, F_m]$,
		\item Chọn cá thể thứ $k$ đầu tiên thỏa $F \geq F_{tk}$ đưa vào quần thể của thế hệ mới.
	\end{itemize}

Sau khi đã thực hiện phép tái sinh, sẽ bắt đầu một vòng lặp mới cho thế hệ mới sinh từ phép chọn cho đến nghiệm hội tụ hoặc chạy hết số vòng lặp được thiết lập. Thuật toán được thể hiện cụ thể theo sơ đồ Hình \ref{fig:genetic-algorithms}. Điều kiện thực hiện ``yes, no'' là nghiệm đã hội tụ hoặc đã chạy hết vòng lặp hay chưa. Tham số đầu vào bao gồm xác suất lai tạo ($p_c$) và đột biến ($p_m$), kích thước quần thể ($N$), thành phần nghiệm của phương trình ($n_{vars}$), hàm lượng giá.

	\begin{figure}[h]
		\centering
		\begin{tikzpicture}[node distance=2cm]
			\node (start) [startstop] {Bắt đầu};
			\node (param) [io, below of=start] {Tham số đầu vào};
			\node (init) [process, below of=param] {Khởi tạo quần thể};
			\node (eval) [decision, below of=init, yshift=-0.5cm] {Đánh giá};
			\node (selection) [process, below of=eval, yshift=-0.3cm] {Lựa chọn};
			\node (crossover) [process, below of=selection, yshift=-0.3cm] {Lai tạo};
			\node (mutation) [process, below of=crossover, yshift=-0.3cm] {Đột biến};
			\node (recreate) [process, below of=mutation, yshift=-0.3cm] {Tái sinh};
			\node (new_pop) [process, right of=recreate, xshift=2.5cm] {Quần thể mới};
			\node (out) [io, below of=recreate] {Kết quả};
			\node (stop) [startstop, left of=eval, xshift=-2cm] {Dừng};

			\draw [arrow] (start) -- (param);
			\draw [arrow] (param) -- (init);
			\draw [arrow] (init) -- (eval);
			\draw [arrow] (eval) -- node[anchor=south] {yes} (stop);
			\draw [arrow] (eval) -- node[anchor=east] {no} (selection);
			\draw [arrow] (selection) -- (crossover);
			\draw [arrow] (crossover) -- (mutation);
			\draw [arrow] (mutation) -- (recreate);
			\draw [arrow] (recreate) -- (new_pop);
			\draw [arrow] (new_pop) |- (eval);
			\draw [arrow] (stop) |- (out);
		\end{tikzpicture}
		\caption{Thuật toán di truyền}
		\label{fig:genetic-algorithms}
	\end{figure}

\clearpage

\subsection{Bài toán thời gian}
Bài toán thời gian hay chuỗi thời gian có thể coi là quá trình ghi chép lại sự thay đổi giá trị của một đại lượng nào đó (áp suất, nhiệt độ, ...) trong một khoảng thời gian liên tục hoặc gần như liên tục.

Tùy thuộc vào từng loại vấn đề khác nhau mà chuỗi thời gian sẽ mang tầng số khác nhau, có thể là theo từng năm (bài toán ngân sách), quý (bài toán tiêu dùng), tháng (bài toán giao thông), tuần (bài toán doanh số), ngày (bài toán thời tiết), giờ (bài toán cổ phiếu), phút (bài toán cuộc gọi), giây (bài toán mạng) hoặc những bài toán mang tính chất riêng biệt khác.

Mục đích của bài toán thời gian chính là dự báo các giá trị của chuỗi trong tương lai để có thể đem lại lợi ích tốt nhất cho công việc. Dự báo chuỗi thời gian có thể được chia làm hai loại:
	\begin{itemize}
		\item Dự báo chuỗi đơn biến và
		\item Dự báo chuỗi đa biến.
	\end{itemize}

\textit{Tính dừng của chuỗi thời gian}

Để giải quyết bài toán thời gian, một giả định được đưa ra chính là chuỗi dữ liệu đó phải có tính ``dừng'', nếu không có giả định này kết quả dự báo sẽ không còn đáng tin cậy. Một chuỗi thời gian được xem là có tính dừng nếu như trung bình, phương sai không đổi theo thời gian và giá trị hiệp phương sai giữa hai đoạn chỉ phụ thuộc vào khoảng cách giữa độ trễ thời gian giữa hai đoạn này chứ không phụ thuộc vào thời điểm thực tế mà hiệp phương sai được tính.

Cụ thể, chuỗi $Y_t$ được gọi là ``dừng'' nếu như đồng thời thỏa mãn ba điều kiện:
	\begin{equation}
		\mu = const \hspace*{.5cm}\& \hspace*{.5cm}\sigma^2 = const
	\end{equation}
	\begin{equation}
		Cov(Y_t)_k = E[(Y_t - \mu), (Y_{t+k} - \mu)]
	\end{equation}
Trong đó $\mu, \sigma^2, Cov(Y_t)$ lần lượt là trung bình, phương sai và hiệp phương sai của chuỗi $Y_t$. $Cov(Y_t)_k$ là hiệp phương sai tại độ trễ $k$ -- là phương sai giữa các giá trị $Y_t, Y_{t+k}$, tức là hai giá trị của $Y$ ở các đoạn thời gian cách quãng $k$. Nếu $k = 0$, $Cov(Y_t)_0 = \sigma^2$, $k = 1$ $Cov(Y_t)_1$ là hiệp phương sai giữa hai giá trị kế cận nhau của $Y$. Như vậy hiệp phương sai của $Y$ chỉ phụ thuộc vào $k$ chứ không phụ thuộc vào thời gian $t$. Một chuỗi thời gian có tính dừng sẽ không có xu thế, không có chu kỳ, mà chỉ dao động xung quanh giá trị kỳ vọng của nó.

Trong thực tế, phần lớn các dữ liệu chuỗi thời gian đều không dừng, nếu như muốn thực hiện dự báo trên các chuỗi này cần có những phương pháp để khắc phục tính không dừng của chuỗi. Một trong các phương pháp đó là sử dụng toán tử sai phân lùi.

Để có thể dễ hiểu hơn, phương pháp cơ bản được triển khai như sau:
	\begin{equation}
		\mathbb{L}(Y_t) = Y_{t-1}
	\end{equation}
Với $\mathbb{L}$ chính là một lần thực hiện toán tử lùi; nói cách khác, thực hiện $\mathbb{L}$ trên $Y_t$, có tác dụng dịch chuyển dữ liệu trở lại một đoạn thời gian.

Áp dụng $\mathbb{L}$ hai lần trên $Y_t$ sẽ chuyển dữ liệu trở lại hai đoạn thời gian:
	\begin{equation}
		\mathbb{L}(\mathbb{L}(Y_t)) = \mathbb{L}^2(Y_t) = Y_{t-2}
	\end{equation}
Toán tử lùi giúp quá trình tính sai phân được dễ dàng hơn. Với sai phân bậc nhất:
	\begin{equation}
		\mathbb{D}(Y_t) = Y_t - Y_{t-1}
	\end{equation}
Với $\mathbb{D}$ là phép tính sai phân. Kết hợp với toán tử lùi, có thể viết lại như sau:
	\begin{equation}
		\mathbb{D}(Y_t) = Y_t - \mathbb{L}(Y_t) = (1 - L)Y_t
	\end{equation}
Tương tự, với sai phân bậc hai sẽ có:
	\begin{equation}
		\Delta^2Y_t = \Delta Y_t - \Delta Y_{t-1} = 1-2\mathbb{L}+\mathbb{L}^2 Y_t = (1 - \mathbb{L})^2Y_t
	\end{equation}
Tổng quát nếu lấy sai phân bậc $d$ sẽ đạt được tính dừng của chuỗi thời gian:
	\begin{equation}
		\Delta^dY_t = (1 - \mathbb{L})^dY_t
	\end{equation}

\section{Đường cong đặc tính gas lift}
Mục tiếp chính khi sử dụng phương pháp gas lift chính là thu được lưu lượng dầu tối đa với lưu lượng gas lift tối ưu nhất. Mối quan hệ giữa hai đại lượng này được thể hiện thông qua đường cong đặc tính gas lift hay Gas Lift Performance Curve (GLPC)\nomenclature{GLPC}{Gas Lift Performance Curve}. Lưu lượng khí bơm ép tối ưu rất quan trọng, bơm dư hoặc thiếu khí đều làm giảm lưu lượng khai thác đồng thời tăng chi phí bơm ép. Mô hình phân phối lưu lượng khí sẽ được xây dựng dựa trên các tính chất của GLPC cho một giếng khai thác. Dòng chảy trong vỉa được giải sử chỉ bao gồm một pha lỏng, trong tubing sẽ là hai pha lỏng - khí, các điều kiện vật lý để tồn tại GLPC là duy nhất.\\

\subsection{Đường cong đặc tính và bài toán tối ưu}\label{glpc-opt-problem}
Đối với một giếng khai thác bắt đầu thực hiện gas lift, sản phẩm khai thác sẽ bao gồm các lưu chất vỉa (dầu, nước) và khí được bơm ép vào trong tubing. Khi đó lưu lượng khai thác có thể được biểu diễn bằng một hàm phụ thuộc vào lưu lượng khí bơm ép:
	\begin{equation}\label{eqn:GLPC}
		q_l = \varphi(q_g)
	\end{equation}
Với:\\
\hspace*{1cm}$q_g$ là lưu lượng khí bơm ép\nomenclature{$q_g$}{Lưu lượng khí bơm ép (MSCF/d)}\\
\hspace*{1cm}$q_l$ là lưu lượng khai thác.\nomenclature{$q_l$}{Lưu lượng khai thác (lỏng) (STB/d)}

Nếu hàm số $\varphi(q_g)$ tồn tại, đồ thị biểu diễn đường cong hàm số \ref{eqn:GLPC} chính là đường đặc tính gas lift (Hình \ref{fig:glpc}). Để \ref{eqn:GLPC} tồn tại $q_g$ phải thỏa mãn điều kiện $0 \leq q_g \leq Q_{gav}$\nomenclature{$Q_{gav}$}{Tổng lượng khí có sẵn} với $Q_{gav}$ là tổng lượng khí có sẵn.

	\begin{figure}[h]
		\centering
		\includegraphics[scale=.6]{fig/glpc.png}
		\caption{Đường đặc tính gas lift}
		\label{fig:glpc}
	\end{figure}

Sử dụng các đặc tính khai thác của mỗi giếng lưu lượng dầu được tính thông qua phương trình:
	\begin{equation}\label{eqn:qo-vs-ql}
		q_o = (1 - WC) \times q_l
	\end{equation}
Với:\\
\hspace*{1cm}WC là hàm lượng nước trong lưu chất khai thác\nomenclature{WC}{Hàm lượng nước}\\
\hspace*{1cm}$q_o$ là lưu lượng dầu.\nomenclature{$q_o$}{Lưu lượng dầu (STB/d)}

Từ các phương trình \ref{eqn:GLPC} và \ref{eqn:qo-vs-ql} được:
	\begin{equation}\label{eqn:qo-vs-qg}
		q_o = (1 - WC) \times \varphi(q_g)
	\end{equation}
Quá trình tối đa hóa lưu lượng dầu sẽ xoay quanh việc tìm giá trị lớn nhất của phương trình \ref{eqn:qo-vs-qg}:
	\begin{equation}\label{eqn:max-qo}
		Max\sum_{k=1}^Nq_o = Max\sum_{k=1}^N(1 - WC) \times \varphi(q_g)
	\end{equation}
Với N là tổng số giếng trong cụm giếng và k là giếng khai thác.\\

\subsection{Mô hình toán học}
Để có thể thực hiện xây dụng mô hình phân phối tối ưu cần đưa bài toán tối ưu như đã nêu ở mục \ref{glpc-opt-problem} trở về dưới dạng tối ưu bằng mô hình toán học. Bắt đầu với phương trình biểu diễn chỉ số năng suất khai thác được suy ra từ định luật Darcy:
	\begin{equation}\label{eqn:darcy-productivity-index}
		J = \dfrac{q_l}{P_r - P_{wf}}
	\end{equation}
Với:\\
\hspace*{1cm}J là chỉ số năng suất\nomenclature{J}{Chỉ số năng suất (STB/d/psi)}\\
\hspace*{1cm}$P_r$ là áp suất vỉa\nomenclature{$P_r$}{Áp suất vỉa}\\
\hspace*{1cm}$P_{wf}$ là áp suất dòng vào tại đáy giếng.\nomenclature{$P_{wf}$}{Áp suất dòng vào tại đáy giếng}

Bằng cách giả sử lưu chất vỉa chỉ tồn tại một pha lỏng (dầu và nước), ta có được:
	\begin{equation}\label{eqn:qo-ql-wc}
		q_l = (1 + WOR) \times q_o = \dfrac{q_o}{1 - WC}
	\end{equation}
Với WOR\nomenclature{WOR}{Tỉ số nước dầu} là tỉ số nước - dầu.

Phương trình dòng chảy cho lưu chất hai pha trong tubing được biểu diển từ \textit{phương trình cân bằng năng lượng}:
	\begin{equation}\label{eqn:energy-balance-equation}
		\dfrac{dP}{dz} = \dfrac{g}{g_c}\overline{\rho}sin(\theta) + \dfrac{f\overline{\rho}u_m^2}{2g_cD} + \dfrac{\overline{\rho}}{2g_c}\dfrac{D}{dz}u_m^2
	\end{equation}
Với điều kiện ban đầu:
	\begin{equation}\label{eqn:initial-cons}
		P(0) = P_{wh}
	\end{equation}
Trong đó:\\
\hspace*{1cm}P: Áp suất mất mát (psi)\nomenclature{P}{Áp suất}\\
\hspace*{1cm}z: Chiều sâu giếng khoan (ft)\nomenclature{z}{Chiều sâu giếng khoan}\\
\hspace*{1cm}g: Gia tốc trọng trường $(\text{ft}/\text{s}^2)$\\
\hspace*{1cm}$g_c$: Hệ số chuyển đổi\\
\hspace*{1cm}$\overline{\rho}$: Tỉ trọng hỗn hợp\nomenclature{$\overline{\rho}$}{Tỉ trọng hỗn hợp}\\
\hspace*{1cm}D: Đường kính tubing (in)\nomenclature{D}{Đường kính tubing (in)}\\
\hspace*{1cm}$f$: Hệ số ma sát\nomenclature{$f$}{Hệ số ma sát}\\
\hspace*{1cm}$u_m$: Vận tốc hỗn hợp (ft/s).\nomenclature{$u_m$}{Vận tốc hỗn hợp (ft/s)}

Các thành phần $\dfrac{g}{g_c}\overline{\rho}sin(\theta)$, $\dfrac{f\overline{\rho}u_m^2}{2g_cD}$ và $\dfrac{\overline{\rho}}{2g_c}\dfrac{d}{dz}u_m^2$ trong phương trình \ref{eqn:energy-balance-equation} tương ứng là tổn hao áp suất do thế năng, ma sát và động năng. Đối với giếng thẳng đứng $sin(\theta) = 1$ do đó thành phần thế năng trở thành $\dfrac{g}{g_c}\overline{\rho}$, thành phần động năng tương đối nhỏ có thể bỏ qua. $\overline{\rho}$ được miêu tả bằng phương trình:
	\begin{equation}\label{eqn:mixture-density}
		\overline{\rho} = H_g\rho_g + (1 - H_g)\rho_l
	\end{equation}
Tỉ trọng của khí $\rho_g$ phụ thuộc áp suất P theo công thức:
	\begin{equation}\label{eqn:gas-density}
		\rho_g = 28.97\dfrac{\gamma_gP}{ZRT}
	\end{equation}
Với:\\
\hspace*{1cm}Z: Hệ số lệch khí\\
\hspace*{1cm}R: Hằng số khí phổ\\
\hspace*{1cm}T: Nhiệt độ trung bình trong tubing.

Tỉ số thể tích khí trong hỗn hợp $H_g$ được tính theo tương quan Zuber-Findlay [cite]:
	\begin{equation}\label{eqn:gas-holdup}
		H_g = \dfrac{u_{sg}}{C_ou_m + U_d}
	\end{equation}
Với:\\
\hspace*{1cm}$u_{sg}$: Tốc độ trượt của khí\\
\hspace*{1cm}$C_o$: Hệ số phân tán\\
\hspace*{1cm}$U_d$: Tốc độ trôi.

Dựa vào \ref{eqn:gas-holdup} có thể tính được $H_g$ khi biết được các hệ số phân tán $C_o$ và tốc độ trôi $U_d$. $C_o$ và $U_d$ cũng được Zuber-Findlay tính toán ra dựa trên thực nghiệm, trong đó $C_o = 1.2$ và $U_d$ được tính theo công thức:
	\begin{equation}\label{eqn:drift-flux}
		U_d = 1.53  \left(\dfrac{g\sigma\Delta\rho}{\rho_L^2}\right)^{0.25}
	\end{equation}
Giá trị $\sigma$ chính là sức căng bề mặt của lưu chất được tính theo các thông số PVT.

Tốc độ của hỗn hợp lưu chất được tính toán từ tốc độ trượt của pha khí và pha lỏng theo các công thức:
	\begin{equation}\label{eqn:mixture-velocity}
		u_m = u_{sl} + u_{sg}
	\end{equation}
	\begin{equation}\label{eqn:usg-usl}
		u_{sl} = \dfrac{q_l}{A},\hspace*{1cm} u_{sg} = \dfrac{ZP_{sc}T}{T_{sc}P}\dfrac{q_g}{A},\hspace*{1cm} A = \pi\dfrac{D^2}{4}
	\end{equation}
Với:\\
\hspace*{1cm}$u_{sl}$: Tốc độ trượt của pha lỏng ($\text{ft}/\text{s}^2$)\\
\hspace*{1cm}$u_{sg}$: Tốc độ trượt của pha khí ($\text{ft}/\text{s}^2$)\\
\hspace*{1cm}A: Tiết diện của tubing.

Hệ số ma sát $f$ trong \ref{eqn:energy-balance-equation} được tính toán từ hệ số Reynolds $Re$ với các chế độ dòng chảy, độ nhám của tubing khác nhau bằng phương trình Colebrook [cite]:
	\begin{equation}\label{eqn:colebrook}
		\dfrac{1}{\sqrt{f}} = 2\times \log_{10}\left(\dfrac{\epsilon/D_h}{3.7} + \dfrac{2.51}{Re\sqrt{f}}\right)
	\end{equation}
Trong đó:\\
\hspace*{1cm}$\epsilon$: độ nhám của tubing\\
\hspace*{1cm}$D_h$: đường kính thủy lực\\
\hspace*{1cm}$Re$: Hệ số Reynolds.

Với tubing có tiết diện tròn đường kính thuy lực $D_h$ chính là đường kính của tubing.

Để có thể thực hiện tính toán một cách dễ dàng hơn, các thông số như áp suất, độ sâu, lưu lượng, tỉ trọng và vận tốc sẽ được tiêu chuẩn hóa bằng cách sử dụng những công thức chuẩn hóa sau:
	\begin{equation}\label{eqn:P-z-scaling}
		\widetilde{P} = \dfrac{P}{P_r},\hspace*{1cm}\widetilde{z} = \dfrac{z}{L}
	\end{equation}
	\begin{equation}\label{eqn:qg-ql-scaling}
		\widetilde{q}_g = \dfrac{q_g}{LD\sqrt{gD}},\hspace*{1cm}\widetilde{q}_l = \dfrac{q_l}{JP_r}
	\end{equation}
	\begin{equation}\label{eqn:rho-velocity}
		\widetilde{\rho} = \dfrac{\overline{\rho}Lg}{g_cP_r},\hspace*{1cm}\widetilde{u} = \dfrac{u_m}{\sqrt{gD}}
	\end{equation}
Như vậy công thức \ref{eqn:energy-balance-equation} và \ref{eqn:darcy-productivity-index} sẽ trở thành:
	\begin{equation}\label{eqn:balance-remake}
		\dfrac{d\widetilde{P}}{d\widetilde{z}} = \widetilde{\rho}(1 + \dfrac{f\widetilde{u}^2}{2})
	\end{equation}
	\begin{equation}
		\widetilde{P}_{wf} = 1 - \widetilde{q}_l
	\end{equation}
Do sự thay đổi của $q_l$ và $q_g$ theo từng giếng nên phương trình đạo hàm tổn hao áp suất có thể được đưa về dạng:
	\begin{equation}\label{eqn:P-z-qg-ql}
		\dfrac{dP_k}{dz_k} = P_k(z_k; q_{gk}, q_{lk})
	\end{equation}
Như vậy, có thể suy ra một phương trình tổng quát từ \ref{eqn:balance-remake} và \ref{eqn:P-z-qg-ql} như sau:
	\begin{equation}\label{eqn:general-equation}
		\widetilde{P}_k(\widetilde{z}_k; \widetilde{q}_{gk}, \widetilde{q}_{lk}) = \widetilde{\rho}_k(1 + \dfrac{f\widetilde{u}_k^2}{2})
	\end{equation}
Khi $\widetilde{z}_k = 0$, áp suất $P_k(0)$ là điều kiện ban đầu của phương trình \ref{eqn:general-equation}; khi $\widetilde{z}_k = 1$, áp suất $P_k$ chính là áp suất tại đáy giếng.
	\begin{equation}\label{eqn:P-z=0}
		\widetilde{P}_k(0; \widetilde{q}_{gk}, \widetilde{q}_{lk}) = \widetilde{P}_{whk}
	\end{equation}
	\begin{equation}\label{eqn:P-z=1}
		\widetilde{P}_k(1; \widetilde{q}_{gk}, \widetilde{q}_{lk}) = 1 - \widetilde{q}_{lk}
	\end{equation}
Với $k = 1, 2, ... , N$, $N$ là tổng số giếng trong hệ thống cụm giếng và đặc tính gas lift của giếng thứ $k$ là:
	\begin{equation}
		q_{lk} = \varphi_k(q_{gk})
	\end{equation}
Quay lại với bài toán tối ưu đã nêu ở mục \ref{glpc-opt-problem}, vấn đề cần giải quyết ở đây chính là tối đa lưu lượng dầu khai thác được trong hệ thống cụm giếng thực hiện bơm ép gas lift. Phương trình \ref{eqn:qo-vs-qg} được miêu tả cụ thể như sau:
	\begin{equation}\label{eqn:1}
		\max(Q_o) = \sum_{k=1}^N(1 - WC_k) \times \varphi_k(q_{gk})
	\end{equation}
Với điều kiện:
	\begin{equation}
		\sum_{k=1}^Nq_{gk} \leq Q_{gav}
	\end{equation}
Bài toán tìm kiếm nghiệm để phương trình \ref{eqn:1} đạt giá trị lớn nhất có thể được đưa về trở thành bài toán tìm nghiệm để \ref{eqn:2} đạt giá trị nhỏ nhất:
	\begin{equation}\label{eqn:2}
		\min \Omega(\overline q_g, \overline q_l) = \dfrac{1}{\sum_{k=1}^N(1 - WC_k)q_{lk}}
	\end{equation}
Trong không gian tìm kiếm:
	\begin{equation}\label{eqn:3}
		D = \left\{(\overline q_g, \overline q_l) \in \mathbb{R}^{2N} |\sum_{k=1}^Nq_{gk} \leq Q_{gav}\right\}
	\end{equation}

\subsection{Giải pháp số}
Để giải quyết bài toán cục tiểu hóa với các ràng buộc như đã nêu ở trên, một phương pháp được đưa ra đó chính là kết hợp giải thuật di truyền với hàm phạt (penalty). Hàm phạt sẽ hướng các cá thể vào không gian tìm kiếm hợp lệ bằng cách cộng thêm các giá trị phạt nếu như một cá thể không phù hợp với điều kiện ràng buộc của bài toán. Khi các cá thể ở trong miền hợp lệ thì giá trị phạt bằng 0, nếu cá thể ở càng xa miền hợp lệ giá trị phạt tăng lên.

Đê sử dụng phương pháp này cần xác định giá trị của hàm phạt, thông qua hệ số phạt $\lambda$, một cách phù hợp. Việc xác định giá trị hàm phạt tùy thuộc vào từng vấn đề tối ưu hóa cụ thể. Với bài toán cực tiểu hóa phương trình \ref{eqn:2}, hàm phạt được thiết lập dựa trên phương trình đạo hàm tổn hao áp suất \ref{eqn:general-equation}. Điều kiện là áp suất tổn hao tại điểm tính toán không được lớn hơn áp suất dòng vào tại đáy giếng, tức là:
	\begin{equation}
		\widetilde{P}_k(\widetilde{z}_k; \widetilde{q}_{gk}, \widetilde{q}_{lk}) \leq 1 - \widetilde{q}_{lk}
	\end{equation}
Phương trình \ref{eqn:2} có thể đưa về dạng kết hợp hàm phạt như sau:
	\begin{equation}\label{eqn:4}
		\min \widehat \Omega(\overline q_g, \overline q_l) = \dfrac{1}{\sum_{k=1}^N(1 - WC_k)q_{lk}} + \lambda\max\{0, \widetilde{P}_k(\widetilde{z}_k; \widetilde{q}_{gk}, \widetilde{q}_{lk}) - (1 - \widetilde{q}_{lk})\}
	\end{equation}
Trong không gian tìm kiếm:
	\begin{equation}\label{eqn:5}
		\widehat D = \left\{(\overline q_g, \overline q_l) \in \mathbb{R}^{2N} |\sum_{k=1}^Nq_{gk} \leq Q_{gav}, 0 \leq q_{lk} \leq 1, k = 1,2,...,N\right\}
	\end{equation}
$\lambda$ là hệ số phạt, nghiệm của \ref{eqn:2} sẽ hội tụ khi $\lambda$ đủ lớn. Vì \ref{eqn:general-equation} là một phương trình đạo hàm chưa biết giá trị cụ thể nên sẽ được tính toán thông qua phương pháp xấp xỉ Runge-Kutta bậc 4.\\

\section{Thuật toán tối ưu}
Thuật toán di truyền kết hợp với hàm phạt sẽ được xây dựng cho phương trình \ref{eqn:4} trong không gian $\widehat D$ như sau:
	\begin{enumerate}
	 	\item Khởi tạo không gian quần thể $POP$ kích thước $n$ với các nhiễm sắc thể $v_1, v_2,...,v_n$ tương ứng với các cặp {$(\overline q_g^{(i)}, \overline q_l^{(i)}), i = 1,2,...,n$} $\subset \widehat D$.
	 	\item Tính toán giá trị $\widetilde{P}_k(\widetilde{z}_k; \overline q_g^{(i)}, \overline q_l^{(i)})$ theo các nhiễm sắc thể $v_1, v_2,...,v_n$ bằng phương pháp Runge-Kutta bậc 4 và đưa ra giá trị hàm phạt.
	 	\item Đánh giá giá trị $\widehat \Omega(\overline q_g^{(i)}, \overline q_l^{(i)})$.
	 	\item Tạo các nhiễm sắc thể mới bằng phép lai và phép đột biến.
	 	\item Sử dụng phép chọn để tạo một quần thể mới kích thước không đổi.
	 	\item Bắt đầu lại với bước 2 cho đến khi nghiệm hội tụ hoặc kết thúc vòng lặp.
	\end{enumerate} 



\end{document}